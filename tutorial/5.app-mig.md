
### 서비스 확인 ###

```
$ kubectl get svc spring-ai
```
![](https://github.com/gnosia93/eks-grv-mig/blob/main/tutorial/images/getsvc-1.png)

서비스 라벨 셀렉터의 값이 app=spring-ai 임을 확인할 수 있다.

### Graviton 노드 테인트 설정하기 ###

taint.sh 파일을 만들어서 Graviton 노드에 테인트를 설정한다. 만약 Graviton 노드에 이미 스케줄링된 파트가 있다면 NoExecute 설정으로 인해 제거된다.
```
$ vi taint.sh
```
```
#!/bin/bash

NODE_LIST=$(kubectl get nodes -o wide | grep aarch64 | cut -d ' ' -f 1 | sed 'N; s/\n/;/')
IFS=';' read -ra my_array <<< "$NODE_LIST"

for i in "${my_array[@]}"
do
    kubectl taint node ${i} arch=arm:NoExecute	
done
```
```
sh taint.sh
```

노드의 테인트 세부정보를 확인한다. 
```
kubectl get nodes -o custom-columns=\
NODE:.metadata.name,\
ARCH:.status.nodeInfo.architecture,\
KERNEL:.status.nodeInfo.kernelVersion,\
KUBLET:.status.nodeInfo.kubeletVersion,\
CPU:.status.capacity.cpu,\
RAM:.status.capacity.memory,\
TAINTS:.spec.taints
```
![](https://github.com/gnosia93/eks-grv-mig/blob/main/tutorial/images/kubectl-getnode-3.png)



### Canary ###








### Blue / Green ###




## 참고자료 ##
* [라벨을 이용한 카나리 배포](https://arisu1000.tistory.com/27842)
* [노드 테인트](https://dobby-isfree.tistory.com/163)
* https://aws.amazon.com/ko/blogs/tech/blue-green-or-canary-amazon-eks-clusters-migration-for-stateless-argocd-workloads/
